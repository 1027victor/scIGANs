#if 0
	shc Version 4.0.1, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -r -f scIGANs.sh -o scIGANs 
#endif

static  char data [] = 
#define      msg1_z	65
#define      msg1	((&data[16]))
	"\042\073\376\336\114\326\343\060\317\046\047\010\221\002\277\254"
	"\360\274\273\261\315\332\165\141\126\000\104\267\036\347\123\331"
	"\175\172\121\070\005\273\001\112\143\373\011\371\364\026\244\073"
	"\061\210\104\167\154\203\155\167\245\224\012\114\234\015\147\317"
	"\075\015\050\113\110\004\375\334\201\110\143\265\017\273\025\135"
	"\264\023\170\114\376\361\173\321\373\364\311"
#define      opts_z	1
#define      opts	((&data[91]))
	"\235"
#define      rlax_z	1
#define      rlax	((&data[92]))
	"\176"
#define      tst2_z	19
#define      tst2	((&data[96]))
	"\070\163\316\041\355\257\267\271\362\063\371\246\154\211\222\216"
	"\204\167\162\151\062\012\150\103\365\220"
#define      inlo_z	3
#define      inlo	((&data[119]))
	"\333\105\147"
#define      pswd_z	256
#define      pswd	((&data[135]))
	"\203\201\245\165\374\166\160\361\100\055\363\052\335\172\331\054"
	"\002\226\320\166\210\251\155\174\006\154\323\340\325\025\351\260"
	"\344\256\240\351\265\121\055\146\205\152\223\003\344\155\057\347"
	"\003\000\136\213\251\314\010\260\071\334\221\016\361\172\277\325"
	"\051\140\277\337\261\355\106\067\127\331\072\074\107\152\044\113"
	"\152\202\326\024\117\337\305\210\274\127\227\255\322\127\203\373"
	"\267\102\333\151\060\041\241\207\373\333\304\102\106\350\215\261"
	"\153\144\306\272\104\214\103\000\343\333\256\265\062\061\261\351"
	"\164\214\123\244\256\364\054\251\320\360\354\026\330\171\310\104"
	"\336\217\377\042\033\102\043\377\036\321\264\120\002\145\072\167"
	"\362\215\034\240\202\110\112\122\071\066\151\022\260\061\126\217"
	"\301\125\261\334\230\325\333\266\246\220\007\251\366\102\040\350"
	"\317\074\211\121\205\323\244\276\012\015\320\273\077\046\112\000"
	"\173\373\334\024\321\270\312\167\110\321\040\076\023\100\047\343"
	"\175\260\065\002\204\331\300\217\347\220\112\046\267\224\046\063"
	"\220\003\107\141\274\021\330\004\343\370\103\367\071\152\333\266"
	"\033\020\270\237\352\171\056\322\011\170\370\300\015\221\066\310"
	"\057\041\000\242\360\151\345\346\371\061\155\214\075\241\063\301"
	"\042\331\066\037\120\247\021\220\324\004\272\261\226\361\172\305"
	"\022\173\150\003\344\116\351"
#define      text_z	2675
#define      text	((&data[767]))
	"\151\275\370\234\176\033\165\265\073\306\134\114\126\061\121\021"
	"\343\347\003\135\254\025\330\025\030\274\143\001\231\343\130\003"
	"\240\121\240\037\154\026\325\250\334\062\364\063\143\105\105\106"
	"\055\110\244\332\135\175\357\166\071\122\170\323\066\321\327\327"
	"\042\167\366\217\215\314\067\151\376\053\235\142\161\342\250\236"
	"\052\115\171\210\312\150\376\004\273\167\330\361\110\257\310\153"
	"\046\277\372\264\213\061\036\212\135\273\354\316\235\225\155\310"
	"\342\346\120\255\117\117\261\012\306\211\373\017\070\303\172\137"
	"\203\164\024\016\245\062\230\003\356\204\322\214\031\077\124\374"
	"\046\244\251\165\363\133\200\272\344\173\311\035\077\103\175\302"
	"\270\221\321\136\304\152\141\262\357\063\076\011\163\222\005\232"
	"\067\257\020\052\012\220\345\357\014\256\015\114\362\213\017\253"
	"\035\340\011\341\113\153\224\072\237\322\103\022\145\111\255\235"
	"\371\275\307\004\116\255\364\132\133\001\246\116\214\265\371\252"
	"\226\003\213\341\156\037\034\015\362\140\040\130\252\315\365\243"
	"\213\275\250\331\152\234\064\306\236\333\025\053\221\016\325\047"
	"\022\140\011\200\200\046\216\163\206\257\313\060\174\300\324\010"
	"\176\175\342\350\031\026\257\267\361\304\342\203\323\267\253\345"
	"\030\264\146\231\333\365\014\141\244\327\222\041\230\147\051\026"
	"\344\013\377\375\042\257\265\024\164\230\227\107\117\102\055\150"
	"\367\224\001\322\211\015\064\056\345\307\117\176\057\171\112\200"
	"\111\373\331\254\257\311\176\267\155\352\021\162\261\021\116\167"
	"\222\345\213\061\357\034\112\220\327\073\164\106\060\131\026\261"
	"\031\362\102\031\064\300\350\076\001\366\243\370\137\025\351\005"
	"\324\203\205\354\136\323\202\164\035\237\230\104\214\156\324\023"
	"\361\213\030\102\334\250\231\371\164\316\364\105\335\020\050\121"
	"\164\366\253\102\331\127\363\210\034\216\157\043\041\231\232\244"
	"\233\334\071\232\027\212\134\156\372\216\376\070\374\031\357\006"
	"\136\020\275\022\017\033\204\121\312\102\204\322\330\364\210\246"
	"\161\052\027\345\063\007\037\340\052\203\270\251\050\170\060\223"
	"\274\131\067\102\202\232\142\204\146\034\162\031\071\376\012\222"
	"\211\137\007\257\356\005\112\044\243\251\035\230\012\344\272\070"
	"\037\071\062\231\336\212\014\074\072\306\054\310\110\274\220\224"
	"\153\066\330\155\255\015\033\235\050\340\274\150\242\252\027\261"
	"\241\265\214\107\312\320\274\050\146\240\257\330\112\225\260\057"
	"\054\142\105\044\171\253\177\062\165\117\237\143\127\312\371\262"
	"\152\064\333\141\375\171\273\235\134\270\124\267\174\201\305\016"
	"\254\052\137\161\250\226\072\335\262\022\062\300\110\376\320\345"
	"\135\056\302\231\221\305\356\057\104\061\271\244\310\312\242\217"
	"\307\243\021\257\046\326\134\007\306\004\051\026\112\371\070\054"
	"\371\244\217\202\250\301\240\241\173\133\235\114\016\356\252\046"
	"\133\271\272\023\307\201\202\255\202\364\367\037\230\256\002\016"
	"\325\323\265\024\115\362\221\267\231\047\101\065\334\222\126\037"
	"\372\116\002\161\032\067\137\320\307\042\303\206\203\140\010\124"
	"\033\140\335\160\137\161\141\267\045\014\137\200\256\233\207\207"
	"\304\232\066\102\103\050\154\235\165\276\130\354\262\015\344\205"
	"\306\130\062\105\016\175\015\022\001\120\227\147\047\351\111\373"
	"\117\055\332\350\033\167\202\343\265\133\366\343\326\350\107\113"
	"\160\220\057\333\024\200\236\143\043\240\156\236\126\142\241\032"
	"\032\207\146\262\202\056\102\051\144\206\151\360\163\247\254\200"
	"\067\276\115\377\002\154\302\137\106\217\124\145\237\012\357\222"
	"\017\217\361\002\026\033\122\375\056\142\015\157\235\314\210\345"
	"\374\034\041\312\342\117\206\162\270\166\332\306\331\005\153\176"
	"\047\236\252\217\322\030\121\174\130\076\006\306\022\321\276\305"
	"\061\332\053\262\357\023\231\124\261\262\211\154\356\114\167\363"
	"\270\222\207\300\060\364\007\332\047\124\317\055\122\102\015\121"
	"\332\057\352\165\025\250\004\121\273\373\245\276\175\112\375\372"
	"\362\247\061\321\144\343\176\036\113\037\334\064\027\170\341\363"
	"\236\100\376\243\130\126\007\362\120\331\075\252\010\133\226\273"
	"\130\261\043\075\036\367\027\267\074\222\104\034\044\121\142\131"
	"\164\310\027\373\123\211\214\376\075\043\247\043\277\072\072\171"
	"\200\065\006\253\325\325\042\350\301\311\060\102\161\201\075\320"
	"\015\221\012\207\274\061\032\024\272\202\055\130\304\011\062\312"
	"\200\344\203\216\325\342\376\302\155\341\246\332\231\376\231\052"
	"\014\040\103\001\346\244\140\203\124\144\236\174\245\005\313\325"
	"\167\376\343\112\043\217\357\223\015\071\070\067\062\277\376\216"
	"\323\132\243\051\201\170\364\030\337\311\021\333\022\011\176\017"
	"\134\260\031\170\247\073\004\170\230\171\257\212\164\377\141\121"
	"\067\066\115\225\276\240\162\063\163\364\302\211\162\202\175\236"
	"\072\062\124\154\274\102\130\226\060\062\152\240\365\035\054\132"
	"\051\344\112\165\054\052\122\345\334\307\163\166\256\255\341\100"
	"\123\253\032\270\256\224\035\324\244\076\160\377\374\115\131\350"
	"\166\256\077\313\213\004\347\110\271\371\245\166\251\355\007\064"
	"\232\314\066\011\236\217\143\273\216\051\132\235\361\344\345\263"
	"\134\054\310\264\334\103\321\060\075\040\222\112\070\047\217\212"
	"\353\203\135\073\150\277\365\123\176\150\325\321\111\344\262\224"
	"\051\020\040\313\233\110\327\303\216\041\070\320\010\315\051\051"
	"\110\057\210\021\064\036\347\364\376\302\266\266\113\232\345\052"
	"\002\320\041\006\247\105\031\175\044\302\330\023\305\253\000\157"
	"\170\137\215\132\134\012\236\236\233\325\003\047\231\121\020\231"
	"\270\347\173\037\320\215\324\305\065\256\253\250\360\261\015\303"
	"\276\302\027\330\104\001\337\115\265\070\104\206\310\241\116\247"
	"\123\056\046\077\070\255\300\006\155\136\144\226\122\047\320\141"
	"\101\373\266\175\313\367\365\153\243\144\274\251\134\040\160\342"
	"\063\013\216\037\154\233\321\354\272\145\275\276\166\026\255\207"
	"\172\220\012\367\047\321\101\376\247\021\266\366\133\036\344\277"
	"\232\253\015\111\340\152\116\221\210\272\325\153\270\302\250\177"
	"\252\001\270\076\142\265\127\211\244\261\261\316\246\124\052\146"
	"\124\216\361\071\276\341\225\364\201\330\223\216\360\250\173\074"
	"\352\230\144\277\172\344\360\232\332\376\050\070\150\153\173\010"
	"\275\067\333\325\361\344\240\007\263\327\201\075\177\050\232\101"
	"\000\224\015\050\344\114\070\065\335\061\165\371\270\243\307\040"
	"\047\045\115\103\007\336\200\223\040\225\332\335\232\206\117\175"
	"\111\006\031\040\163\351\071\247\216\330\316\220\061\115\265\270"
	"\201\144\251\224\114\151\156\076\117\137\063\025\015\041\245\313"
	"\151\333\002\132\027\311\113\265\002\065\262\265\267\114\065\274"
	"\353\032\143\001\005\014\025\171\145\174\344\273\047\051\002\216"
	"\043\176\042\331\324\114\254\313\227\326\144\117\210\301\221\305"
	"\245\145\055\224\002\016\210\011\114\144\142\157\073\244\133\313"
	"\336\230\334\355\145\217\356\166\351\021\353\144\345\220\273\145"
	"\110\101\307\154\334\137\052\012\021\214\014\317\105\103\105\327"
	"\321\351\235\017\012\223\273\334\357\223\067\171\251\255\003\223"
	"\066\065\344\000\026\163\237\055\246\116\261\246\377\072\113\167"
	"\247\050\025\351\166\023\115\304\201\167\355\073\367\367\364\112"
	"\317\056\226\235\325\116\225\315\140\250\113\166\000\262\215\003"
	"\252\226\203\362\134\237\366\316\301\352\121\136\232\204\142\173"
	"\312\354\255\056\207\004\264\275\003\143\031\261\020\371\114\162"
	"\267\221\362\365\016\101\266\161\076\166\305\065\263\321\374\337"
	"\044\120\215\305\174\243\007\320\223\322\055\176\142\303\310\003"
	"\325\117\161\176\313\345\135\341\164\255\206\264\134\053\261\375"
	"\031\057\256\141\050\164\166\322\066\252\076\336\006\244\317\135"
	"\273\122\062\251\366\215\206\021\013\245\012\105\266\033\334\106"
	"\145\375\141\016\136\177\032\100\020\060\040\060\211\314\111\104"
	"\201\102\251\366\010\055\113\274\045\156\366\312\156\144\354\201"
	"\344\125\244\322\014\301\146\147\040\026\107\006\140\065\263\265"
	"\226\260\217\301\251\026\352\164\314\155\011\227\323\070\127\032"
	"\212\221\027\267\031\153\320\012\263\011\327\331\114\064\333\213"
	"\043\134\255\013\377\266\116\106\036\341\155\153\325\023\064\137"
	"\101\047\350\350\136\062\054\260\010\074\202\003\247\166\242\373"
	"\373\362\376\305\072\256\331\372\141\374\140\114\035\142\226\006"
	"\022\057\251\113\113\245\331\033\332\240\076\141\355\271\375\124"
	"\051\355\237\033\343\113\063\373\157\004\345\107\121\201\312\174"
	"\345\275\275\314\031\065\222\305\311\150\120\137\334\066\375\231"
	"\250\375\054\026\124\212\051\274\115\224\142\025\373\127\223\251"
	"\227\137\102\221\137\301\313\056\100\315\232\343\012\326\113\301"
	"\232\245\032\311\043\071\211\047\032\247\073\324\127\157\270\175"
	"\252\320\051\076\131\113\233\157\207\240\152\225\173\330\173\234"
	"\012\161\350\112\324\077\022\117\014\154\251\125\321\074\242\117"
	"\251\343\111\173\026\316\273\350\047\144\064\273\253\107\325\366"
	"\343\072\371\301\233\147\212\105\145\160\360\144\204\351\374\365"
	"\161\315\167\072\375\351\051\206\002\203\305\045\257\306\367\250"
	"\053\107\273\255\250\016\014\326\254\060\333\063\056\355\143\266"
	"\147\234\053\077\240\073\273\367\201\273\115\277\304\063\227\120"
	"\277\042\076\303\216\373\166\202\123\222\335\317\117\234\076\235"
	"\314\147\120\125\154\007\255\303\315\314\001\305\004\345\145\237"
	"\376\231\031\065\112\110\130\101\153\027\313\130\265\046\201\122"
	"\225\156\262\262\307\001\026\200\243\212\134\014\244\311\316\247"
	"\350\275\076\062\215\347\326\254\204\045\124\045\231\267\334\131"
	"\302\010\033\040\136\270\103\353\372\170\306\362\014\366\033\002"
	"\311\141\166\167\075\166\302\046\272\211\323\320\317\153\346\250"
	"\113\371\300\027\144\305\151\175\141\376\057\006\146\336\341\171"
	"\234\035\020\160\335\011\353\115\344\341\272\373\015\056\344\004"
	"\050\004\040\362\000\026\357\311\000\307\221\064\106\252\306\121"
	"\076\236\277\124\356\374\012\224\161\271\332\201\313\137\214\256"
	"\265\262\040\113\150\344\130\035\232\335\074\374\336\000\213\203"
	"\012\003\306\112\076\232\343\066\053\037\023\072\075\261\320\312"
	"\357\372\132\371\357\356\303\147\075\047\244\131\107\357\070\115"
	"\356\234\041\263\164\003\123\027\137\260\300\052\046\126\072\217"
	"\205\053\363\057\330\140\013\260\342\376\101\017\237\311\122\273"
	"\064\365\222\267\244\251\241\010\250\130\015\113\307\244\273\053"
	"\072\301\017\130\152\232\140\062\060\250\251\034\124\305\376\010"
	"\356\231\232\356\366\124\306\111\232\331\316\371\223\277\034\213"
	"\356\265\157\135\335\157\232\331\050\132\313\050\364\104\267\055"
	"\155\302\102\357\267\145\216\032\053\364\307\170\101\001\072\147"
	"\203\221\363\317\105\264\366\365\135\230\200\126\127\274\252\304"
	"\052\173\300\261\002\357\321\371\256\016\014\055\124\277\121\023"
	"\077\105\045\106\244\212\167\140\325\176\150\251\311\372\123\072"
	"\115\131\164\350\312\014\066\000\222\071\354\265\126\145\300\206"
	"\342\340\317\273\106\107\232\324\140\120\321\007\047\366\323\114"
	"\230\000\061\110\236\055\302\066\107\175\023\040\012\014\312\307"
	"\153\100\167\013\241\053\134\020\047\202\071\303\273\304\353\212"
	"\317\371\162\361\123\072\114\101\262\122\204\122\160\203\275\152"
	"\016\374\331\233\321\177\050\173\015\263\041\100\227\122\101\000"
	"\345\105\003\214\175\322\341\053\245\247\154\111\242\060\027\170"
	"\001\201\054\326\155\232\170\137\051\100\130\361\253\162\164\146"
	"\233\101\032\251\074\375\045\217\257\356\101\050\100\072\275\223"
	"\120\263\025\036\331\276\254\370\225\373\240\136\175\006\344\237"
	"\316\126\000\177\206\066\250\314\165\107\245\175\372\121\303\246"
	"\067\034\034\267\175\331\165\114\326\321\133\043\121\325\176\165"
	"\215\124\030\117\027\040\150\357\337\345\265\022\212\276\273\340"
	"\153\244\351\073\164\044\327\203\250\220\167\167\111\134\327\266"
	"\074\373\233\246\231\326\061\060\041\277\276\026\127\163\243\275"
	"\245\264\315\217\245\125\266\301\345\370\235\077\263\172\347\122"
	"\314\011\212\342\025\127\253\130\370\231\202\045\213\033\176\133"
	"\224\175\342\343\164\337\212\346\367\361\137\013\054\020\364\274"
	"\125\345\151\344\276\225\112\160\220\065\140\262\264\271\332\337"
	"\362\103\252\361\307\311\361\171\075\366\207\230\076\361\173\145"
	"\303\004\206\154\043\252\014\006\113\216\036\161\061\070\347\111"
	"\015\346\337\302\325\202\042\223\010\366\313\265\072\177\216\323"
	"\254\040\130\147\131\147\063\315\342\153\216\377\077\077\325\205"
	"\260\017\347\017\234\332\266\233\152\374\173\126\267\333\120\126"
	"\106\046\332\212\373\113\077\172\234\104\163\340\204\102\207\047"
	"\261\161\137\360\202\061\012\146\073\356\055\203\313\226\120\034"
	"\321\220\054\014\030\362\153\366\165\246\214\231\064\163\115\234"
	"\051\007\270\251\230\100\250\171\357\314\232\342\016\344\261\062"
	"\137\361\005\350\001\057\171\154\057\113\172\231\034\141\144\205"
	"\321\051\360\340\222\027\240\260\265\052\022\320\314\204\101\271"
	"\040\214\337\065\267\271\235\112\135\264\013\334\051\124\036\255"
	"\320\224\023\205\224\021\247\104\307\274\270\137\123\377\257\226"
	"\055\027\216\301\031\141\113\047\226\172\014\135\311\212\214\103"
	"\037\240\311\264\262\161\370\171\055\260\330\201\260\207\030\335"
	"\237\246\237\270\010\352\337\236\144\354\373\056\166\210\162\225"
	"\051\073\112\333\254\102\124\332\362\055\133\242\264\163\177\124"
	"\032\037\014\042\011\354\301\156\330\274\235\117\105\017\345\156"
	"\113\057\111\370\161\236\322\144\313\056\006\200\242\206\324\274"
	"\245\341\337\257\316\240\036\247\135\273\366\243\313\333\021\027"
	"\013\133\017\174\372\342\341\306\020\347\106\262\156\033\157\024"
	"\375\116\303\313\357\342\162\115\236\151\360\152\104\002\201\120"
	"\136\221\315\130\163\256\037\203\226\145\065\004\201\245\031\176"
	"\364\335\111\343\277\274\061\135\045\041\307\152\044\111\272\202"
	"\332\207\333\115\065\372\321\314\140\007\321\341\254\352\137\240"
	"\307\251\204\206\145\265\344\212\327\253\364\374\364\256\176\316"
	"\066\132\034"
#define      lsto_z	1
#define      lsto	((&data[3668]))
	"\207"
#define      shll_z	10
#define      shll	((&data[3671]))
	"\011\226\172\023\243\235\355\341\066\361\177\105\241\363"
#define      chk2_z	19
#define      chk2	((&data[3684]))
	"\236\166\277\102\231\137\107\033\307\322\266\136\334\336\341\044"
	"\221\055\070\110\306\101\004"
#define      tst1_z	22
#define      tst1	((&data[3706]))
	"\021\161\132\264\154\027\174\342\071\275\120\147\201\177\377\116"
	"\320\270\022\100\132\106\124\321\202"
#define      xecc_z	15
#define      xecc	((&data[3734]))
	"\317\224\150\122\227\037\116\210\234\216\303\026\266\324\066\036"
	"\241\171"
#define      date_z	1
#define      date	((&data[3749]))
	"\310"
#define      chk1_z	22
#define      chk1	((&data[3753]))
	"\063\224\026\202\376\260\204\316\322\205\241\306\307\140\152\114"
	"\251\121\134\246\066\003\037\243\340"
#define      msg2_z	19
#define      msg2	((&data[3776]))
	"\277\047\110\266\040\212\344\106\003\335\343\056\216\301\276\161"
	"\320\227\267\024"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define HARDENINGSP	0	/* Define as 1 to disable bash child process */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a processs */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;

    int lentmp = len;

#if HARDENINGSP
    //Start tracing to protect from dump & trace
    if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }

    //Decode Bash
    while (len > 0) {
        indx++;
        tmp = stte[indx];
        jndx += tmp;
        stte[indx] = stte[jndx];
        stte[jndx] = tmp;
        tmp += stte[indx];
        *ptr ^= stte[tmp];
        ptr++;
        len--;
    }

    //Exec bash script
    system(tmp2);

    //Empty script variable
    memcpy(tmp2, str, lentmp);

    //Sinal to detach ptrace
    ptrace(PTRACE_DETACH, 0, 0, 0);
    exit(0);

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
#endif /* HARDENINGSP Exit here anyway*/

    int pid, status;
    pid = fork();

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            printf("Operation not permitted\n");
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Exec bash script
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {
        wait(&status);
    }

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
} 
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
